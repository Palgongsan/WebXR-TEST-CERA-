<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Model Viewer AR - Quick</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    /* PATCH NOTES:
       - 변경 이유: AR에서 모델 스케일 고정 및 프리뷰 단계에서 사용자의 줌(휠/핀치) 차단.
       - 영향범위: index.html 내 model-viewer 동작(프리뷰 + AR).
       - 롤백: 아래에 적힌 두 속성(remove "disable-zoom" and "ar-scale")을 제거하거나 원본 백업을 복원하면 됩니다.
    */

    /* 한 줄 요약: 프리뷰 배경색 조정용 CSS 변수(:root --preview-bg). 필요하면 이 값만 수정하세요. */
    :root { --preview-bg: #ffffff; /* Preview background color - change this to adjust backdrop */ }

    /* 페이지 레이아웃 */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--preview-bg); /* preview 배경색 적용 */
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    /* model-viewer 스타일 (미리보기 카드 형태) */
    model-viewer {
      width: 90vw;
      height: 80vh;
      max-width: 1200px;
      max-height: 900px;
      border-radius: 12px;
      box-shadow: 0 6px 30px rgba(0,0,0,.6);
      background: #ffffff; /* 모델 주변 기본 배경 (안정용) */
      transition: box-shadow .18s ease;
      display: block;
    }

    /* 간단한 모바일/데스크탑 터치 힌트 스타일 (선택사항) */
    .hint {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(255,255,255,0.9);
      font-size: 13px;
      background: rgba(0,0,0,0.4);
      padding: 6px 10px;
      border-radius: 999px;
      pointer-events: none;
      user-select: none;
    }
  </style>
</head>
<body>
  <!--
    한 줄 요약(한국어): AR 모드에서 사용자가 모델 스케일을 변경하지 못하게 고정(ar-scale="fixed"),
    프리뷰(비-AR)에서 핀치/휠 줌을 차단(disable-zoom). 모델 파일명은 'model.glb'로 가정.
    필요하면 model.glb 파일명만 바꿔서 사용하세요.
  -->
  <model-viewer
    id="mv"
    src="model.glb"                                  <!-- 교체: 실제 모델 파일명으로 변경 -->
    alt="Product Preview"
    ar                                              <!-- AR 버튼/플로우 자동 생성 -->
    ar-modes="webxr scene-viewer quick-look"       <!-- WebXR, Android Scene Viewer, iOS Quick Look 자동 선택 -->
    camera-controls                                 <!-- 사용자는 카메라 회전(orbit) 가능 -->
    disable-zoom                                    <!-- 프리뷰(비-AR)에서 pinch/휠 줌 비활성화 -->
    ar-scale="fixed"                                <!-- AR 모드에서 스케일 고정 (사용자 스케일 조작 차단) -->
    auto-rotate
    exposure="1"
    style="touch-action: none;"                     <!-- 터치 제스처 충돌을 막음 -->
  >
    <!-- fallback 콘텐츠 -->
    <div class="hint">AR 버튼을 눌러서 공간에 세라젬을 배치해보세요</div>
  </model-viewer>

  <script>
    // 간단 안내: background 색을 동적으로 바꾸고 싶으면 아래처럼 조작할 수 있습니다.
    // 한 줄 요약(한국어): 페이지 미리보기 배경을 JS로 변경하는 예시
    // Example: document.documentElement.style.setProperty('--preview-bg', '#223344');

    // (선택) 모델 로딩 상태를 모니터링하여 UX 향상(로더 표시 등)을 추가할 수 있음.
    const mv = document.querySelector('#mv');
    mv.addEventListener('load', () => {
      console.log('model-viewer: model loaded');
    });
    mv.addEventListener('error', (e) => {
      console.error('model-viewer error:', e);
    });

    // 참고: iOS Quick Look(USDZ)에서 스케일 동작이 플랫폼 종속적일 수 있으므로
    // iOS에서 특별히 문제가 발생하면 추가 폴백 로직을 적용해야 함.
  </script>
</body>
</html>
