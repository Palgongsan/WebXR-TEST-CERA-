<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Model Viewer AR - Quick</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
  <style>
    /* PATCH NOTES:
       - 변경 이유: AR에서 모델 스케일 고정 및 프리뷰 단계에서 사용자의 줌(휠/핀치) 차단.
       - 영향범위: index.html 내 model-viewer 동작(프리뷰 + AR).
       - 롤백: 아래에 적힌 두 속성(remove "disable-zoom" and "ar-scale")을 제거하거나 원본 백업을 복원하면 됩니다.
    */

    /* 한 줄 요약: 프리뷰 배경색 조정용 CSS 변수(:root --preview-bg). 필요하면 이 값만 수정하세요. */
    :root { --preview-bg: #ffffff; /* Preview background color - change this to adjust backdrop */ }

    /* 페이지 레이아웃 */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--preview-bg); /* preview 배경색 적용 */
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    /* model-viewer 스타일 (미리보기 카드 형태) */
    model-viewer {
      width: 100%;
      height: 80vh;
      max-width: 1200px;
      max-height: 900px;
      border-radius: 12px;
      box-shadow: 0 6px 30px rgb(116, 116, 116);
      background: #ffffff; /* 모델 주변 기본 배경 (안정용) */
      transition: box-shadow .18s ease;
      display: block;
    }

  /* 힌트 오버레이 스타일 (하단 중앙) */
  #custom-hint {
    position: fixed;
    left: 50%;
    bottom: 24px;                 /* 데스크탑 기본 위치 */
    transform: translateX(-50%);
    background: rgba(20,20,20,0.75);
    color: #fff;
    padding: 10px 14px;
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
    font-family: "Pretendard", system-ui, -apple-system, "Segoe UI",
                 Roboto, "Noto Sans KR", "Helvetica Neue", Arial;
    font-size: 14px;
    line-height: 1;
    z-index: 9999;
    display: inline-flex;
    gap: 8px;
    align-items: center;
    pointer-events: auto;
    transition: opacity 260ms ease, transform 260ms ease;
  }

  /* 닫기 버튼 */
  #custom-hint button {
    background: transparent;
    border: none;
    color: #fff;
    opacity: 0.9;
    cursor: pointer;
    font-size: 13px;
    padding: 6px;
    border-radius: 6px;
  }
  #custom-hint button:focus { outline: 2px solid #fff6; }

  /* 모바일에서는 AR 버튼과 겹치지 않게 올림 */
  @media (max-width: 820px) {
    #custom-hint { bottom: 86px; font-size: 13px; padding: 9px 12px; }
  }

  /* 작은 화면(핸드헬드 아주 작음) */
  @media (max-width: 420px) {
    #custom-hint { bottom: 100px; font-size: 12px; padding: 8px 10px; border-radius: 8px; }
  }

  /* 숨김 시 애니메이션 */
  #custom-hint.hidden { opacity: 0; transform: translate(-50%, 8px); pointer-events: none; }
  </style>
</head>
<body>
  <model-viewer
    id="mv"
    src="model.glb"
    alt="Product Preview"
    ar
    ar-modes="webxr scene-viewer quick-look"
    camera-controls
    disable-zoom
    ar-scale="fixed"
    auto-rotate
    exposure="1"
    style="touch-action: none;">
  </model-viewer>

  <div id="custom-hint">
  AR버튼을 눌러서 제품을 배치해보세요
  </div>

  <script>
    // 간단 안내: background 색을 동적으로 바꾸고 싶으면 아래처럼 조작할 수 있습니다.
    // 한 줄 요약(한국어): 페이지 미리보기 배경을 JS로 변경하는 예시
    // Example: document.documentElement.style.setProperty('--preview-bg', '#223344');

    // (선택) 모델 로딩 상태를 모니터링하여 UX 향상(로더 표시 등)을 추가할 수 있음.
    const mv = document.querySelector('#mv');
    mv.addEventListener('load', () => {
      console.log('model-viewer: model loaded');
    });
    mv.addEventListener('error', (e) => {
      console.error('model-viewer error:', e);
    });

    // 참고: iOS Quick Look(USDZ)에서 스케일 동작이 플랫폼 종속적일 수 있으므로
    // iOS에서 특별히 문제가 발생하면 추가 폴백 로직을 적용해야 함.
  </script>
</body>
</html>
